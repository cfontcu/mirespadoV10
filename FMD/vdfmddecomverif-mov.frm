#CAMPO=CODBULTO,AUXILIAR,OCULTO,"_40_"

BEGINBLOQUE=VDLEERBULTO.PAN
#   PREBLOQUE=FEJECUTA("CINITLECSCANNER","ERROR INICIALIZANDO SCANNER",
#                     FCOMMIT,"ERROR HACIENDO COMMIT")

#  TIMEOUT=FEJECUTATIME("@CSELLECTURA","",
#                        FPULSATECLAS("F2"),"ERROR EN FPULSATECLAS",
#                        "CUPDLECTURA","ERROR ACTUALIZANDO LECTURA",
#                        FCOMMIT,""),100

  PREREGISTRO=PRESEHIJO
  POSX=1
  POSY=1
  CAMPO=SEQACCION,AUXILIAR,OCULTO,"@L@@@@@@@"

  CURSOR=CINITLECSCANNER UPDATE VDSCANLECT SET STATUS = 200 
                          WHERE REDSCAN IN (SELECT IDINFOLECTURA FROM VDORDENADORES, SYS.V_$SESSION WHERE ORDENADOR = TERMINAL AND AUDSID=USERENV('SESSIONID'))
                            AND STATUS = 100;

  CURSOR=CSELLECTURA SELECT SEQACCION, SUBSTR(TEXTO,3,18) CODBULTO
                       FROM VDSCANLECT SCA, VDORDENADORES ORD, SYS.V_$SESSION S
                      WHERE AUDSID=USERENV('SESSIONID') AND
                            ORD.ORDENADOR = S.TERMINAL AND
                            ORD.IDINFOLECTURA = SCA.REDSCAN AND
                            SCA.STATUS = 100 
                      ORDER BY SEQACCION DESC;
  
  CURSOR=CUPDLECTURA UPDATE VDSCANLECT
                        SET STATUS = 200
                      WHERE SEQACCION = :SEQACCION;                     

ENDBLOQUE

BEGINBLOQUE=VDFMDDECOMVERIF.PAN
  PADRE=VDLEERBULTO.PAN
  PREREGISTRO=PRESEHIJO   
  
  
#  PREBLOQUE=FEJECUTA("CINITLECSCANNER","ERROR INICIALIZANDO SCANNER",
#                     FCOMMIT,"ERROR HACIENDO COMMIT")
  
#  TIMEOUT=FEJECUTATIME("@CSELLECTURA","",
#                       FPULSATECLAS("F2"),"ERROR EN FPULSATECLAS",
#                       "CUPDLECTURA","ERROR ACTUALIZANDO LECTURA",
#                       FCOMMIT,""),100

  PREREGISTRO=PRESEHIJO
  POSX=1
  POSY=7
  CAMPO=SEQACCION,AUXILIAR,OCULTO,"@L@@@@@@@"

  CURSOR=CINITLECSCANNER UPDATE VDSCANLECT SET STATUS = 200 
                          WHERE REDSCAN IN (SELECT IDINFOLECTURA FROM VDORDENADORES, SYS.V_$SESSION WHERE ORDENADOR = TERMINAL AND AUDSID=USERENV('SESSIONID'))
                            AND STATUS = 100;

  CURSOR=CSELLECTURA SELECT SEQACCION, SUBSTR(TEXTO,3) CODBIDI
                       FROM VDSCANLECT SCA, VDORDENADORES ORD, SYS.V_$SESSION S
                      WHERE AUDSID=USERENV('SESSIONID') AND
                            ORD.ORDENADOR = S.TERMINAL AND
                            ORD.IDINFOLECTURA = SCA.REDSCAN AND
                            SCA.STATUS = 100 
                      ORDER BY SEQACCION DESC;
  
  CURSOR=CUPDLECTURA UPDATE VDSCANLECT
                        SET STATUS = 200
                      WHERE SEQACCION = :SEQACCION;  
  
  
ENDBLOQUE

BEGINBLOQUE=VDFMDDECOMVERIF2.PAN
  PREREGISTRO=PRESEHIJO
  PADRE=VDFMDDECOMVERIF.PAN
  POSX=1
  POSY=12
  AQUERY
ENDBLOQUE

BEGINBLOQUE=VDFMDDECOMVERIF3.PAN  
  PADRE=VDFMDDECOMVERIF2.PAN
  POSX=79
  POSY=1
  AQUERY
ENDBLOQUE

