# MOdulo   : VDEJECUTAMOV.FRM
# Función  : Lista de ejecución manual de movimientos
#
# Creación : 25-04-2008
# Autor    : RFD
###########################################
# HistOrico de cambios:
BEGINBLOQUE=VDEJECUTAMOV.PAN
    CAMPO=FLUJOPED,AUXILIAR,OCULTO,"_255_"
    PREREGISTRO=PRESEHIJO
    PREQUERY=FEJECUTA("CSELFLUJOSPED","ERROR OBTENIENDO FLUJOS PARA PEDIDOS")
#    WHERE=CODUBIORI IN (SELECT CODUBI FROM VDUBICA WHERE CODAREA='HR') AND CODUBIDEST IN (SELECT CODUBI FROM VDUBICA WHERE CODAREA IN ('HR','RP')) AND 
#          CODMATORI!=CODMATDEST AND 
#          STATUS BETWEEN VDST.FMOVPDTERUTA AND VDST.FMOVENUBIINTER 
#                AND CODMOV IN 
#        (SELECT CODMOVESP FROM VDMOVIM MOV WHERE STATUS<VDST.FMOVPDTERECOGE AND CODMOVESP+0>0
#         UNION 
#         SELECT CODMOV FROM VDMOVIM WHERE STATUS=VDST.FMOVPDTERECOGE AND CODMOVESP+0=0
#         AND VD.CONTIENECAD(NVL(:FLUJOPED,0),TAREA,'#') !=1
#        UNION
#        SELECT CODMOV FROM VDMOVIM MOV WHERE STATUS=VDST.FMOVPDTERECOGE AND CODMOVESP+0>0 
#                AND NOT EXISTS (SELECT 1 FROM VDMOVIM MOV2 WHERE CODMOV=MOV.CODMOVESP AND STATUS<VDST.FMOVDEPOSITADO)
#                AND VD.CONTIENECAD(NVL(:FLUJOPED,0),TAREA,'#') !=1);

# INCLUYE MOVIMIENTOS DE PEDIDO   
   WHERE=STATUS BETWEEN VDST.FMOVPDTERUTA AND VDST.FMOVENUBIINTER 
                AND CODMOV IN 
        (SELECT CODMOVESP FROM VDMOVIM MOV WHERE STATUS<VDST.FMOVPDTERECOGE AND CODMOVESP+0>0
         UNION 
         SELECT CODMOV FROM VDMOVIM WHERE STATUS=VDST.FMOVPDTERECOGE AND CODMOVESP+0=0
        UNION
        SELECT CODMOV FROM VDMOVIM MOV WHERE STATUS=VDST.FMOVPDTERECOGE AND CODMOVESP+0>0 
                AND NOT EXISTS (SELECT 1 FROM VDMOVIM MOV2 WHERE CODMOV=MOV.CODMOVESP AND STATUS<VDST.FMOVDEPOSITADO));

    ORDERBY=CODUBIORI,CODMATORI,CODUBIDEST;
    
    CURSOR=CSELFLUJOSPED SELECT VD.GETPROP('FLUJOSPEDIDO') FLUJOPED FROM DUAL;
    REGPAG=30
    POSX=1
    POSY=1
ENDBLOQUE

